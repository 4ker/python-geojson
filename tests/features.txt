Tests of the feature protocol
=============================

A dictionary can satisfy the protocol
-------------------------------------

  >>> f = {
  ...   'type': 'Feature',
  ...   'id': '1',
  ...   'geometry': {'type': 'Point', 'coordinates': [0, 0]},
  ...   'properties': {'title': 'Dict 1'},
  ... }

  >>> import geojson

  Encoding

  >>> json = geojson.dumps(f)
  >>> json
  '{"geometry": {"crs": {"type": "EPSG", "properties": {"code": 4326}}, "type": "Point", "coordinates": [0, 0]}, "type": "Feature", "properties": {"title": "Dict 1"}, "id": "1"}'

  Decoding

  >>> o = geojson.loads(json)
  >>> o
  {u'geometry': {u'crs': {u'type': u'EPSG', u'properties': {u'code': 4326}}, u'type': u'Point', u'coordinates': [0, 0]}, u'type': u'Feature', u'properties': {u'title': u'Dict 1'}, u'id': u'1'}


feature class
---------------------

  >>> from geojson.examples import SimpleWebFeature
  >>> feature = SimpleWebFeature(id='1',
  ...             geometry={'type': 'Point', 'coordinates': [0.0, 0.0]},
  ...             title=u'Feature 1', summary=u'The first feature',
  ...             link='http://example.org/features/1')

  It satisfies the feature protocol

  >>> feature.id
  '1'
  >>> feature.properties['title']
  u'Feature 1'
  >>> feature.properties['summary']
  u'The first feature'
  >>> feature.properties['link']
  'http://example.org/features/1'
  >>> feature.geometry
  {'type': 'Point', 'coordinates': [0.0, 0.0]}

  Encoding

  >>> geojson.dumps(feature)
  '{"geometry": {"crs": {"type": "EPSG", "properties": {"code": 4326}}, "type": "Point", "coordinates": [0.0, 0.0]}, "type": "Feature", "properties": {"summary": "The first feature", "link": "http:\\/\\/example.org\\/features\\/1", "title": "Feature 1"}, "id": "1"}'

  Decoding

  >>> factory = geojson.examples.createSimpleWebFeature
  >>> json = '{"geometry": {"type": "Point", "coordinates": [0.0, 0.0]}, "id": "1", "properties": {"summary": "The first feature", "link": "http:\\/\\/example.org\\/features\\/1", "title": "Feature 1"}}'
  >>> feature = geojson.loads(json, object_hook=factory)
  >>> type(feature)
  <class 'geojson.examples.SimpleWebFeature'>
  >>> feature.id
  '1'
  >>> feature.properties['title']
  u'Feature 1'
  >>> feature.properties['summary']
  u'The first feature'
  >>> feature.properties['link']
  'http://example.org/features/1'
  >>> feature.geometry
  {'type': 'Point', 'coordinates': [0.0, 0.0]}

Test the geo interface
----------------------

  >>> class Thingy(object):
  ...     def __init__(self, id, title, x, y):
  ...         self.id = id
  ...         self.title = title
  ...         self.x = x
  ...         self.y = y
  ...     @property
  ...     def __geo_interface__(self):
  ...        return {"id": self.id, "properties": {"title": self.title}, "geometry": {"type": "Point", "coordinates": (self.x, self.y)}}

  >>> ob = Thingy('1', 'thingy one', -106.0, 40.0)
  >>> ob.__geo_interface__['geometry']
  {'type': 'Point', 'coordinates': (-106.0, 40.0)}
  >>> geojson.dumps(ob)
  '{"geometry": {"type": "Point", "coordinates": [-106.0, 40.0]}, "id": "1", "properties": {"title": "thingy one"}}'
